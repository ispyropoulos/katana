- aside_class = cookies[:left_panel_collapsed] == 'true' ? "collapsed" : nil
%aside.left-panel{ class: aside_class }
  .logo
    = link_to root_url, class: "logo-expanded" do
      %i.ion-social-buffer
      %img{alt: "logo", src: image_path("logo.png"), width: '45'}
      %span.nav-label Testributor
  - if current_project
    .text-center
      %span.nav-label Live workers:
      %span.badge.badge-sm.bg-purple.count= current_project.active_workers
  %nav.navigation
    %ul.list-unstyled
      - if current_project
        :ruby
          conditions_for_active_project = [
            current_page?(project_path(current_project)),
            controller_name == 'test_runs'
          ]
        %li{ class: conditions_for_active_project.inject{|a,b| a||b} ? 'active' : nil }
          = link_to project_path(current_project) do
            %i.fa.fa-dashboard
            %span.nav-label= current_project.name
        %li{ class: current_page?(project_files_path(current_project)) ? 'active' : nil }
          = link_to project_files_path(current_project) do
            %i.fa.fa-folder-open
            %span.nav-label Files
        - # TODO: use cancancan authorization instead of this
        - if current_user == current_project.user
          %li{ class: current_page?(new_project_invitation_path(current_project)) ? 'active' : nil }
            = link_to new_project_invitation_path(current_project) do
              %i.fa.fa-users
              %span.nav-label= t('invite_users')
        %li{ class: current_page?(settings_project_path(current_project)) ? 'active' : nil }
          = link_to settings_project_path(current_project) do
            %i.fa.fa-cog
            %span.nav-label= "Settings"
      - else
        %li
          = link_to project_wizard_path(:add_project) do
            %i.fa.fa-plus
            %span.nav-label Add a project
